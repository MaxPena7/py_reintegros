<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Formato de Reintegro</title>
<style>

@page {
    size: letter;
    margin-top:10.5cm;
    margin-right: 1.5cm;
    margin-bottom: 1.5cm;
    margin-left: 1.5cm;
}

body {
    font-family: Arial, sans-serif;
    letter-spacing: 1.5px;
    line-height: 1.2;
    background-image: url("fondo_page.jpg");
    background-repeat: no-repeat;
    background-position: center top;
    background-size: cover;
    background-color: transparent;
    margin-top: 5cm;

    /* Ajuste de impresión */
    print-color-adjust: exact;          /* estándar moderno */
    -webkit-print-color-adjust: exact;  /* compatibilidad con WebKit/wkhtmltopdf */
}

h3 {
    text-align: center;
    margin: 0;
    padding: 0;
    font-size: 16px;
}
.header {
    text-align: center;
    font-weight: bold;
    font-size: 16px;
    margin-bottom: 20px;
}
.finish {
    text-align: center;
    margin-top: 60px;
    margin-bottom: 20px;
}
.fecha-derecha {
    text-align: right;
    font-weight: bold;
    margin-bottom: 10px;
    font-size: 12px;
}
table {
    border-collapse: collapse;
    table-layout: fixed;
}
th, td {
    border: 1px solid black;
    padding: 3px 4px;
    font-size: 10px;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
}
th {
    background-color: #f0f0f0;
    font-weight: bold;
    font-size: 11px;
    text-align: center;
}
/* Columnas para tablas de percepciones y deducciones */
.col-cpto { width: 9.75%; text-align: center; }
.col-desc { width: 59.75%; text-align: left; }
.col-imp { width: 17%; text-align: right; }

tfoot td {
    font-weight: bold;
    font-size: 11px;
    background-color: #f0f0f0;
}

.info-grid {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid black;
    margin-top: 15px;
    margin-bottom: 15px;
}
.info-grid td {
    border: 1px solid black;
    padding: 5px;
    vertical-align: top;
    font-size: 12px;
}
.info-cell-label { font-weight: bold; }

/* Tablas de percepciones y deducciones - FLOTANTES */
.tabla-percepciones {
    width: 50%;
    float: left;
    margin: 15px 0 0 0;
    padding-right: 0;
}
.tabla-deducciones {
    width: 50%;
    float: right;
    margin: 15px 0 0 0;
    padding-left: 0;
}

/* NUEVAS CLASES PARA TOTALES */
.total-cell {
    font-size: 12px;
    font-weight: bold;
}
.total-liquido {
    clear: both;
    width: 100%;
    box-sizing: border-box;
    text-align: right;
    font-weight: bold;
    font-size: 12px;
    padding: 5px;
    border: 1px solid black;
    background-color: #f0f0f0;
    box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.3);
    margin-top: 0;
}
</style>
</head>
<body>
<div class="header">
 COORDINACIÓN DE LOS SERVICIOS EDUCATIVOS DEL ESTADO DE COLIMA<br>
 SUBDIRECCIÓN DE CAPITAL HUMANO<br>
 SUBJEFATURA DE NÓMINA<br>
</div>

<div class="fecha-derecha"> {{ fecha_hoy }} </div>

<h3>SOLICITUD DE REINTEGRO</h3>

<!-- INFORMACIÓN GENERAL DEL EMPLEADO -->
<table class="info-grid">
<tr>
<td colspan="4">
 <span class="info-cell-label">SIRVASE RECIBIR DEL (DE LA) C:</span> {{ nombre_completo }}
</td>
</tr>
<tr>
<td colspan="2"><span class="info-cell-label">FILIACION:</span> {{ rfc }}</td>
<td colspan="2"><span class="info-cell-label">CLAVE DE COBRO:</span> {{ clave_cobro }}</td>
</tr>
<tr>
<td colspan="2"><span class="info-cell-label">QNA(s):</span> {{ qna }}</td>
<td><span class="info-cell-label">DESDE:</span> {{ desde }}</td>
<td><span class="info-cell-label">HASTA:</span> {{ hasta }}</td>
</tr>
<tr>
<td colspan="2"><span class="info-cell-label">TIPO DE REINTEGRO:</span> {{ motivo_reintegro }}</td>
<td colspan="2">
 <span class="info-cell-label">NO. COMPROBANTE:</span> {{ no_comprobante }}<br>
 <span class="info-cell-label">CENTRO DE TRABAJO:</span> {{ cct }}
</td>
</tr>
<tr>
<td colspan="4" style="white-space: normal; word-wrap: break-word;">
 <span class="info-cell-label">MOTIVO DE REINTEGRO:</span> {{ campo_abajo_motivo }}
</td>
</tr>
<tr>
<td colspan="2"><span class="info-cell-label">NIVEL EDUCATIVO:</span> {{ nivel_educativo }}</td>
<td colspan="2" style="background-color: #f0f0f0; font-weight: bold;"><span class="info-cell-label">TOTAL A REINTEGRAR: </span> {{ total_a_reintegrar }}</td>
</tr>
</table>

<!-- PERCEPCIONES -->
<table class="tabla-percepciones">
<thead>
<tr>
<th class="col-cpto">CPTO</th>
<th class="col-desc">DESCRIPCIÓN DEL CONCEPTO</th>
<th class="col-imp">IMPORTE</th>
</tr>
</thead>
<tbody>
{% set max_filas = [percepciones|length, deducciones|length]|max %}
{% for i in range(max_filas) %}
{% if i < percepciones|length %}
{% set p = percepciones[i] %}
<tr>
<td class="col-cpto">{{ p.COD_CONCEPTO }}</td>
<td class="col-desc">{{ p.DESC_CONCEPTO }}</td>
<td class="col-imp">${{ "{:,.2f}".format(p.IMPORTE) }}</td>
</tr>
{% else %}
<tr>
<td class="col-cpto">&nbsp;</td>
<td class="col-desc">&nbsp;</td>
<td class="col-imp">&nbsp;</td>
</tr>
{% endif %}
{% endfor %}
</tbody>
<tfoot>
<tr>
<td colspan="2" style="text-align:right;">TOTAL PERCEPCIONES</td>
<td class="col-imp total-cell">${{ "{:,.2f}".format(total_percepciones) }}</td>
</tr>
</tfoot>
</table>

<!-- DEDUCCIONES -->
<table class="tabla-deducciones">
<thead>
<tr>
<th class="col-cpto">CPTO</th>
<th class="col-desc">DESCRIPCIÓN DEL CONCEPTO</th>
<th class="col-imp">IMPORTE</th>
</tr>
</thead>
<tbody>
{% for i in range(max_filas) %}
{% if i < deducciones|length %}
{% set d = deducciones[i] %}
<tr>
<td class="col-cpto">{{ d.COD_CONCEPTO }}</td>
<td class="col-desc">{{ d.DESC_CONCEPTO }}</td>
<td class="col-imp">${{ "{:,.2f}".format(d.IMPORTE) }}</td>
</tr>
{% else %}
<tr>
<td class="col-cpto">&nbsp;</td>
<td class="col-desc">&nbsp;</td>
<td class="col-imp">&nbsp;</td>
</tr>
{% endif %}
{% endfor %}
</tbody>
<tfoot>
<tr>
<td colspan="2" style="text-align:right;">TOTAL DEDUCCIONES</td>
<td class="col-imp total-cell">${{ "{:,.2f}".format(total_deducciones) }}</td>
</tr>
</tfoot>
</table>
<!-- TOTAL LÍQUIDO -->
<div class="total-liquido">
 TOTAL LÍQUIDO: ${{ "{:,.2f}".format(total_liquido) }}
</div>

</div>

<div class="finish">
    <div style="border-bottom: 1px solid black; width: 60%; margin: 140px auto 10px auto; height: 1px;"></div>
    <h3>LICDA. MYRIAN ELIZABETH SEGURA AGUILERA</h3>
    <h3>SUBJEFA DE NÓMINA</h3>
</div>

</body>
</html>
